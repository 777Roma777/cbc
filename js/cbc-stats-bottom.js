"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,_toPropertyKey(a.key),a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);n=n.call(e,t||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}window.CBC||(window.CBC={}),(CBC=CBC||window.CBC).APP||(CBC.APP={}),CBC.APP.AB||(CBC.APP.AB={}),CBC.APP.ANA||(CBC.APP.ANA={}),CBC.APP.ANA.ABTESTSCONFIG||(CBC.APP.ANA.ABTESTSCONFIG={}),CBC.APP.ANA.DISPATCHERS||(CBC.APP.ANA.DISPATCHERS={}),CBC.APP.ANA.DISPATCHERS.Adobe||(CBC.APP.ANA.DISPATCHERS.Adobe={}),CBC.APP.ANA.DISPATCHERS.Amplitude||(CBC.APP.ANA.DISPATCHERS.Amplitude={}),CBC.APP.ANA.DISPATCHERS.FBPIXEL||(CBC.APP.ANA.DISPATCHERS.FBPIXEL={}),CBC.APP.ANA.DISPATCHERS.MirRoar||(CBC.APP.ANA.DISPATCHERS.MirRoar={}),CBC.APP.ANA.ER||(CBC.APP.ANA.ER={}),CBC.APP.ANA.FORMATTERS||(CBC.APP.ANA.FORMATTERS={}),CBC.APP.ANA.FORMATTERS.Adobe||(CBC.APP.ANA.FORMATTERS.Adobe={}),CBC.APP.ANA.FORMATTERS.Amplitude||(CBC.APP.ANA.FORMATTERS.Amplitude={}),CBC.APP.ANA.FORMATTERS.Common||(CBC.APP.ANA.FORMATTERS.Common={}),CBC.APP.ANA.FORMATTERS.Comscore||(CBC.APP.ANA.FORMATTERS.Comscore={}),CBC.APP.ANA.FORMATTERS.MirRoar||(CBC.APP.ANA.FORMATTERS.MirRoar={}),CBC.APP.ANA.LIBRARY||(CBC.APP.ANA.LIBRARY={}),CBC.APP.ANA.LIBRARY.Amplitude||(CBC.APP.ANA.LIBRARY.Amplitude={}),CBC.APP.ANA.LIBRARY.FBPIXEL||(CBC.APP.ANA.LIBRARY.FBPIXEL={}),CBC.APP.ANA.LIBRARY.SENTRY||(CBC.APP.ANA.LIBRARY.SENTRY={}),CBC.APP.ANA.LinkTracker||(CBC.APP.ANA.LinkTracker={}),CBC.APP.ANA.SEARCHDEFAULT||(CBC.APP.ANA.SEARCHDEFAULT={}),CBC.APP.ANA.VALIDATORS||(CBC.APP.ANA.VALIDATORS={}),CBC.APP.ANA.VALIDATORS.Adobe||(CBC.APP.ANA.VALIDATORS.Adobe={}),CBC.APP.ANA.VALIDATORS.Amplitude||(CBC.APP.ANA.VALIDATORS.Amplitude={}),CBC.APP.ANA.VALIDATORS.Common||(CBC.APP.ANA.VALIDATORS.Common={}),CBC.APP.ANA.VALIDATORS.FBPIXEL||(CBC.APP.ANA.VALIDATORS.FBPIXEL={}),CBC.APP.ANA.VALIDATORS.MirRoar||(CBC.APP.ANA.VALIDATORS.MirRoar={}),CBC.APP.ANA.VARS||(CBC.APP.ANA.VARS={}),CBC.APP.COMSCORE||(CBC.APP.COMSCORE={}),CBC.APP.CXENSE||(CBC.APP.CXENSE={}),CBC.APP.DMP||(CBC.APP.DMP={}),CBC.APP.DMP.LOTAME||(CBC.APP.DMP.LOTAME={}),CBC.APP.PubSub||(CBC.APP.PubSub={}),CBC.APP.readJS||(CBC.APP.readJS={}),CBC.APP.SC||(CBC.APP.SC={}),CBC.APP.SC.DTM||(CBC.APP.SC.DTM={}),CBC.APP.SC.DTM.DATA||(CBC.APP.SC.DTM.DATA={}),CBC.APP.SC.DTM.formatted||(CBC.APP.SC.DTM.formatted={}),CBC.APP.SC.EventTracker||(CBC.APP.SC.EventTracker={}),CBC.APP.SC.LOCALGEO||(CBC.APP.SC.LOCALGEO={}),CBC.APP.SC.masterSwitch||(CBC.APP.SC.masterSwitch={}),CBC.APP.SC.metadataAllowlist||(CBC.APP.SC.metadataAllowlist={}),CBC.APP.SC.PageTracker||(CBC.APP.SC.PageTracker={}),CBC.APP.SC.Pillar||(CBC.APP.SC.Pillar={}),CBC.APP.SC.Subscribers||(CBC.APP.SC.Subscribers={}),CBC.APP.SC.UTIL||(CBC.APP.SC.UTIL={}),CBC.APP.SC.VideoHeartbeat||(CBC.APP.SC.VideoHeartbeat={}),CBC.APP.SC.VideoHeartbeatVars||(CBC.APP.SC.VideoHeartbeatVars={}),CBC.APP.versions||(CBC.APP.versions={}),window.CBCRC||(window.CBCRC={}),(CBCRC=CBCRC||window.CBCRC).ANA||(CBCRC.ANA={}),CBCRC.ANA.DATALAYER||(CBCRC.ANA.DATALAYER={}),CBCRC.ANA.MEDIA||(CBCRC.ANA.MEDIA={}),CBC.APP.versions["cbc-stats-bottom"]="2.145.0",CBC.APP.SC.Detectizr=function(e){var t=e||(window.navigator.userAgent||window.navigator.vendor||window.opera).toLowerCase();function n(e){return e.test(t)}function a(e){return-1<t.indexOf(e)}function o(e){return e.exec(t)}function i(e,t){t=(e.version=t).split(".");0<t.length?(t=t.reverse(),e.major=t.pop(),0<t.length?(e.minor=t.pop(),0<t.length?(t=t.reverse(),e.patch=t.join(".")):e.patch="0"):e.minor="0"):e.major="0"}var e={type:"",model:""},r={},s=["tv","tablet","mobile","desktop"];return n(/googletv|smarttv|smart-tv|internet.tv|netcast|nettv|appletv|boxee|kylo|dlnadoc|roku|pov_tv|hbbtv|ce-html/)?(e.type=s[0],e.model="smartTv"):n(/xbox|playstation.3|wii/)?(e.type=s[0],e.model="gameConsole"):n(/ip(a|ro)d/)?(e.type=s[1],e.model="ipad"):n(/tablet/)&&!n(/rx-34/)||n(/folio/)?(e.type=s[1],e.model=String(o(/playbook/)||"")):n(/linux/)&&n(/android/)&&!n(/fennec|mobi|htc.magic|htcX06ht|nexus.one|sc-02b|fone.945/)?(e.type=s[1],e.model="android"):n(/kindle/)||n(/mac.os/)&&n(/silk/)?(e.type=s[1],e.model="kindle"):n(/gt-p10|sc-01c|shw-m180s|sgh-t849|sch-i800|shw-m180l|sph-p100|sgh-i987|zt180|htc(.flyer|_flyer)|sprint.atp51|viewpad7|pandigital(sprnova|nova)|ideos.s7|dell.streak.7|advent.vega|a101it|a70bht|mid7015|next2|nook/)||n(/mb511/)&&n(/rutem/)?(e.type=s[1],e.model="android"):n(/bb10/)?(e.type=s[1],e.model="blackberry"):(e.model=o(/iphone|ipod|android|blackberry|opera mini|opera mobi|skyfire|maemo|windows phone|palm|iemobile|symbian|symbianos|fennec|j2me/),null!==e.model?(e.type=s[2],e.model=String(e.model)):(e.model="",n(/bolt|fennec|iris|maemo|minimo|mobi|mowser|netfront|novarra|prism|rx-34|skyfire|tear|xv6875|xv6975|google.wireless.transcoder/)||n(/opera/)&&n(/windows.nt.5/)&&n(/htc|xda|mini|vario|samsung-gt-i8000|samsung-sgh-i9/)?e.type=s[2]:n(/windows.(nt|xp|me|9)/)&&!n(/phone/)||n(/win(9|.9|nt)/)||n(/\(windows 8\)/)?e.type=s[3]:n(/macintosh|powerpc/)&&!n(/silk/)?(e.type=s[3],e.model="mac os"):n(/cros/)?e.type=s[3]:e.type=s[2])),""!==e.model&&("ipad"===e.model||"iphone"===e.model||"ipod"===e.model?(r.name="ios",i(r,(n(/os\s([\d_]+)/)?RegExp.$1:"").replace(/_/g,"."))):"android"===e.model?(r.name="android",i(r,n(/android\s([\d.]+)/)?RegExp.$1:"")):"blackberry"===e.model?(r.name="blackberry",i(r,n(/version\/([^\s]+)/)?RegExp.$1:"")):"playbook"===e.model&&(r.name="blackberry",i(r,n(/os ([^\s]+)/)?RegExp.$1.replace(";",""):""))),r.name||(a("win")||a("16bit")?(r.name="windows",a("windows nt 10")?i(r,"10"):a("windows nt 6.3")?i(r,"8.1"):a("windows nt 6.2")||n(/\(windows 8\)/)?i(r,"8"):a("windows nt 6.1")?i(r,"7"):a("windows nt 6.0")?i(r,"vista"):(a("windows nt 5.2")||a("windows nt 5.1")||a("windows xp"))&&i(r,"xp")):a("mac")||a("darwin")?(r.name="mac os",a("os x")&&i(r,(n(/os\sx\s([\d_]+)/)?RegExp.$1:"os x").replace(/_/g,"."))):a("webtv")?r.name="webtv":(a("x11")||a("inux"))&&(r.name="linux")),{os:r,device:e,ua:t}},window.Detectizr=CBC.APP.SC.Detectizr(),function(){var e;Object.keys(CBC.APP.PubSub).length||(e=function(){function a(e,t,n){_classCallCheck(this,a),this.subscribers=e||{},this.queuedEvents=t||[],this.isOn=n||!1}return _createClass(a,[{key:"turnOn",value:function(){if(this.isOn=!0,this.queuedEvents.length)for(var e=0;e<this.queuedEvents.length;e++)this.publish(this.queuedEvents[e].event,this.queuedEvents[e].payload),this.queuedEvents.splice(e,1)}},{key:"turnOff",value:function(){this.isOn=!1}},{key:"isOn",value:function(){return this.isOn}},{key:"publish",value:function(t,n){t in this.subscribers?this.subscribers[t].slice().forEach(function(e){try{e(t,n)}catch(e){console.error(e.message)}}):this.isOn||this.queuedEvents.push({event:t,payload:n})}},{key:"subscribe",value:function(e,t){return e in this.subscribers||(this.subscribers[e]=[]),this.subscribers[e].some(function(e){if(t===e)return!0})?(console.log("callback already exists for event:",e,t),!1):(this.subscribers[e].push(t),!0)}},{key:"unsubscribe",value:function(e,a){e in this.subscribers&&this.subscribers[e].some(function(e,t,n){if(a===e)return n.splice(t,1),!0})}}]),a}(),CBC.APP.PubSub=new e)}(),CBC.APP.SC.viafouraSubscribed=!1,function(){function n(e,t){Array.isArray(t)&&0!==t.length&&(t=CBC.APP.DMP.LOTAME.filterAudienceSegmentIDs(t,["Amplitude"])).length&&(CBC.APP.ANA.FORMATTERS.Amplitude.mUP("set","user.segments.dmp.ids",t),CBC.APP.PubSub.unsubscribe("loadedAudiences",n))}window.vfQ=window.vfQ||[],window.vfQ.push(function(){CBC.APP.SC.viafouraSubscribed||(CBC.APP.SC.DEBUG&&console.log("Subscribing to Viafoura events"),window.vf.$subscribe("share","clicked",function(e,t){CBC.APP.SC.EventTracker.trackEvent("SHARED",{network:e,elem:t})}),window.vf.$subscribe("logout","success",function(){CBC.APP.SC.EventTracker.trackEvent("SIGNED OUT",{})}),window.vf.$subscribe("comment","created",function(e){CBC.APP.SC.EventTracker.trackEvent("COMMENTED",{})}),window.vf.$subscribe("comment-reply","posted",function(e){CBC.APP.SC.EventTracker.trackEvent("COMMENTED",{})}),CBC.APP.SC.viafouraSubscribed=!0,CBC.APP.PubSub.publish("viafouraAvailable",{}))}),CBC.APP.PubSub.subscribe("loadedAudiences",n)}(),window._sf_endpt=(new Date).getTime(),CBC.APP.COMSCORE={useBeacon:!1,payload:{c1:2,c2:3005684},dataStructure:{},Call:function(){if(CBC.APP.SC.DTM.formatted.comscore&&(this.dataStructure=CBC.APP.SC.DTM.formatted.comscore),this.useBeacon)this.pvCandidate();else{this.useBeacon=!0;var e="",t={};if(Object.keys(this.dataStructure).length){if(this.dataStructure.syndicate&&"gamp"===this.dataStructure.syndicate)return!1;e=this.getC6(),t=this.getOptions()}e={c3:"",c4:escape(window.location.href),c5:"CBC.ca-CanadianNewsSportsEntertainmentKidsDocsRadioTV",c6:e,c15:"",options:t},t=window._comscore||[],e=(t.push(this.generatePayload(e,this.payload)),window._comscore=t,this.pvCandidate(),document.createElement("script")),t=document.getElementsByTagName("script")[0];e.async=!0,e.src="https://sb.scorecardresearch.com/beacon.js",t&&t.parentNode.insertBefore(e,t)}},getC6:function(){var e="";return this.dataStructure.subsection3?e=this.dataStructure.subsection3:this.dataStructure.subsection2?e=this.dataStructure.subsection2:this.dataStructure.subsection1&&(e=this.dataStructure.subsection1),e},getOptions:function(){var e,t,n={};return this.dataStructure.syndicate&&"fia"===this.dataStructure.syndicate?n={url_append:"comscorekw=fbia"}:this.useBeacon&&this.dataStructure.contentarea&&"homepage"!==this.dataStructure.contentarea&&(t=this.dataStructure.contentarea,e=this.dataStructure.subsection1,n={url_append:"comscorekw=".concat("news"===t&&e?e:t)}),document.getElementById("comscore-comment-div")&&document.getElementById("comscore-comment-div").remove(),n.url_append&&(e=document.createElement("div"),t=document.createComment("comScore Identifier: ".concat(n.url_append)),e.id="comscore-comment-div",e.appendChild(t),document.body.appendChild(e)),n},generatePayload:function(e,t){return Object.assign({},e,t)},pvCandidate:function(){var e=this.getOptions(),e=(window.COMSCORE&&window.COMSCORE.beacon(this.generatePayload(this.payload,{options:e})),void 0!==e.url_append?e.url_append+"&":"");CBC.APP.SC.UTIL.makeGETRequest("//www.cbc.ca/g/stats/comscore.json?".concat(e,"cache=").concat((new Date).getTime()),{success:function(e,t){JSON.parse(e.responseText).comscore||console.log("COMSCORE-bottom: json response error")},failure:function(e,t){console.log("COMSCORE-bottom: json request error")}},{success:{success:!0},failure:{success:!1}})}},Object.keys(CBC.APP.CXENSE).length||(CBC.APP.CXENSE={addMetaTags:function(){for(var e=document.querySelectorAll("meta[name^=cXenseParse]"),t=0;t<e.length;t++)e[t].parentNode.removeChild(e[t]);var n,a,o,i,r=CBC.APP.SC.DTM.formatted.cxense,s=document.querySelector("head");for(o in r&&r.contenttype&&(a="article","index"===r.contenttype&&(a="frontpage",r.contentarea)&&["video","kids","tv"].includes(r.contentarea.toLowerCase())&&(a="article","video"!==r.contentarea||r.contentid||(a="frontpage"),r.subsection1)&&["index","search"].includes(r.subsection1.toLowerCase())&&(a="frontpage"),a=this.createMetaTag("cXenseParse:","pageclass",a),s.appendChild(a)),r&&r.contenttype&&"index"===r.contenttype&&r.contentarea&&["video","kids","tv","life"].includes(r.contentarea.toLowerCase())&&(r.pillar&&"legacyee"===r.pillar?(n=r.subsection2?r.subsection2.replace(/[^a-zA-Z0-9"]/g," "):"",n+=r.subsection3&&"home"!==r.subsection3?" "+r.subsection3.replace(/[^a-zA-Z0-9"]/g," "):"",a=this.createMetaTag("cXenseParse:","cbc-keymatch",n),s.appendChild(a)):"video"===r.contentarea&&r.contentid&&(n=r.subsection3?r.subsection3.replace(/[^a-zA-Z0-9"]/g," "):"",a=this.createMetaTag("cXenseParse:","cbc-keymatch",n),s.appendChild(a))),r)!{}.hasOwnProperty.call(r,o)||(i=this.createMetaTag("cXenseParse:cbc-",o,r[o]),s.appendChild(i),"publishedTime"!==o||isNaN(parseInt(r[o]))||(i=this.createMetaTag("article:","published_time",new Date(parseInt(r[o])).toISOString(),"property"),s.appendChild(i)),"updatedTime"!==o)||isNaN(parseInt(r[o]))||(i=this.createMetaTag("article:","modified_time",new Date(parseInt(r[o])).toISOString(),"property"),s.appendChild(i))},createMetaTag:function(e,t,n){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"name",o=document.createElement("meta");return o.setAttribute(a,e+t),o.setAttribute("content",n),o},pageView:function(){CBC.APP.CXENSE.addMetaTags(),window.cX.callQueue.push(["sendPageViewEvent"])}}),function(){var e,t,n;window.cX=window.cX||{},window.cX.callQueue=window.cX.callQueue||[],window.cX.callQueue.push(["setSiteId","9222369215399074873"]),n=document,e="script",(t=n.createElement(e)).type="text/java"+e,t.async="async",t.src="https://scdn.cxense.com/cx.js",(n=n.getElementsByTagName(e)[0])&&n.parentNode.insertBefore(t,n)}(),CBC.APP.PubSub.subscribe("CLOSED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("COMMENTED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("FOLLOWED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("LISTENED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.ESS.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("LOADED",function(e,t){CBC.APP.ANA.VALIDATORS.Adobe.trackPageView(t),CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.Comscore.trackPageLoad(),CBC.APP.ANA.VALIDATORS.Cxense.trackPageLoad(),CBC.APP.ANA.VALIDATORS.Chartbeat.trackPageLoad(),CBC.APP.ANA.VALIDATORS.ESS.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.FBPIXEL.trackEvent()}),CBC.APP.PubSub.subscribe("LOADED MORE",function(e,t){CBC.APP.ANA.VALIDATORS.Adobe.trackPageView(t),CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.Comscore.trackPageLoad(),CBC.APP.ANA.VALIDATORS.Cxense.trackPageLoad(),CBC.APP.ANA.VALIDATORS.Chartbeat.trackPageLoad(),CBC.APP.ANA.VALIDATORS.FBPIXEL.trackEvent()}),CBC.APP.PubSub.subscribe("NEXT",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("OPENED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("PLAYED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("PREVIOUS",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("READ",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.ESS.trackEvent(e,t),CBC.APP.AB.sendEventGoalToConductrics(e,{})}),CBC.APP.PubSub.subscribe("SEARCHED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("SELECTED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("SET PREFERENCE",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("SHARED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("SIGNED IN",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t),CBC.APP.SC.DTM.DATA.authenticated=CBC.APP.SC.PageTracker.isLoggedIn(),CBC.APP.SC.UTIL.setFormattedLayer(),CBC.APP.SC.UTIL.sendDataToUIE(t)}),CBC.APP.PubSub.subscribe("SIGNED OUT",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t),CBC.APP.SC.DTM.DATA.authenticated=CBC.APP.SC.PageTracker.isLoggedIn(),CBC.APP.SC.UTIL.setFormattedLayer(),CBC.APP.SC.UTIL.removeCBCPlusID(),CBC.APP.SC.UTIL.sendDataToUIE(t)}),CBC.APP.PubSub.subscribe("START WEB SESSION",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("STREAMED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t),CBC.APP.AB.sendEventGoalToConductrics(e,t),CBC.APP.SC.UTIL.sendDataToUIE(t),CBC.APP.ANA.VALIDATORS.ESS.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("SUBMITTED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("SUBSCRIBED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t),CBC.APP.SC.UTIL.sendDataToUIE(t)}),CBC.APP.PubSub.subscribe("UIEAlert",function(){CBC.APP.ANA.VALIDATORS.FBPIXEL.setUserOptinFlag()}),CBC.APP.PubSub.subscribe("UNFOLLOWED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("UNSUBSCRIBED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t),CBC.APP.SC.UTIL.sendDataToUIE(t)}),CBC.APP.PubSub.subscribe("VIEWED AD",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("WATCHED",function(e,t){CBC.APP.ANA.VALIDATORS.Amplitude.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.MirRoar.trackEvent(e,t),CBC.APP.ANA.VALIDATORS.ESS.trackEvent(e,t)}),CBC.APP.PubSub.subscribe("mediaAdBreakCompleted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaAdBreakStarted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaBufferCompleted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaBufferStarted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaChapterStarted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaChapterCompleted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaCompleted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaPaused",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaPlayStarted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaSeekStarted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaSeekCompleted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaSessionCompleted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.PubSub.subscribe("mediaSessionStarted",function(e,t){try{CBC.APP.ANA.VALIDATORS.HarmonizedAdobe.trackMediaState(e,t)}catch(e){}}),CBC.APP.ANA.VALIDATORS.Adobe=function(){function t(e){if(s_cbc_sitecatalyst){if(CBC.APP.SC.masterSwitch.switches&&CBC.APP.SC.masterSwitch.switches.adobe)return CBC.APP.ANA.FORMATTERS.Adobe.formatSignal(e)}else CBC.APP.SC.UTIL.console("The Adobe s_code.js is missing on the page");return!1}return{trackPageView:function(e){if(!CBC.APP.SC.masterSwitch.switches||null!=CBC.APP.SC.masterSwitch.switches.adobe)return t(e);CBC.APP.SC.UTIL.masterSwitchMetaPromise().then(function(){return t(e)})}}}(),CBC.APP.ANA.VALIDATORS.Amplitude=function(){function n(e,t){if(CBC.APP.SC.masterSwitch.switches.amplitude)return CBC.APP.ANA.LIBRARY.Amplitude.isInitialized()&&CBC.APP.ANA.LIBRARY.Amplitude.isOn()?CBC.APP.ANA.FORMATTERS.Amplitude.formatSignal(e,t):(a.push([e,t]),e="EventTracker - Warning: Amplitude is not turned on or initialized but the tracked events have been queued: "+e+" "+t,CBC.APP.SC.DEBUG&&"undefined"!=typeof console&&"function"==typeof console.log&&console.log(e),!1)}var a=[];return{trackEvent:function(e,t){if(null!=CBC.APP.SC.masterSwitch.switches.amplitude)return n(e,t);CBC.APP.SC.UTIL.masterSwitchMetaPromise().then(function(){return n(e,t)})},executeQueue:function(){if(CBC.APP.ANA.FORMATTERS.Amplitude.executeUPQueue(),a.length){for(var e=0;e<a.length;e++)n(a[e][0],a[e][1]);a=[]}}}}(),CBC.APP.ANA.VALIDATORS.Common={validateAppName:function(e){return CBC.APP.SC.UTIL.getMetadataAllowlist().metadata.allowlist.app.name[e]},validateFromAllowlist:function(e,t){for(var n=CBC.APP.SC.UTIL.getMetadataAllowlist().metadata.allowlist,a=e.split("."),o=n,i=0;i<a.length;i++){var r=a[i];if(!("object"===_typeof(o)&&null!==o&&r in o))return;o=o[r]}return o.pattern?new RegExp(o.pattern).test(t):o[t]},getFeatureNameRegex:function(){return["^tab\\.(\\w+-?\\w*)+$","^tab\\.(\\w+-?\\w*)+\\.card$","^tab\\.(\\w+-?\\w*)+\\.card\\.label$","^category\\.list\\.card$","^tab\\.sections\\.list$","^tab\\.sections\\.regions\\.list$","^tab\\.sections\\.list\\.card$","^tab\\.sections\\.regions\\.list\\.card$","^tab\\.local\\.editors-picks\\.\\b(\\w*[-]?\\w*)\\b$","^tab\\.local\\.pub-time\\$*","^search$","^tab\\.(\\w+-?\\w*)+\\.(\\w+-?\\w*)+\\.card$","^deeplink\\.(notification|widget|url|search)$","^story\\.(leadmedia|leadgallery|leadimage|similarlink|hyperlink|relatedlink|photogallery|image)$","^tab\\.(\\w+-?\\w*)+\\.content-package\\.(main-visual|title|link-[\\d]+)$","^tab\\.(\\w+-?\\w*)+\\.(\\w+-?\\w*)+\\.more$"]},validatePlayedContentType:function(e){return!(e.event_properties&&e.event_properties.content&&"game"!==e.event_properties.content.type||e.content&&"game"!==e.content.type)}},CBC.APP.ANA.VALIDATORS.MirRoar=function(){function n(e,t){if(CBC.APP.SC.masterSwitch.switches.MirRoar)CBC.APP.ANA.FORMATTERS.MirRoar.formatSignal(e,t)}return{trackEvent:function(e,t){null==CBC.APP.SC.masterSwitch.switches.MirRoar?CBC.APP.SC.UTIL.masterSwitchMetaPromise().then(function(){n(e,t)}):n(e,t)}}}(),CBC.APP.ANA.VALIDATORS.Comscore={trackPageLoad:function(){CBC.APP.COMSCORE&&!CBC.APP.SC.UTIL.isIOSWebviewPrivate()&&CBC.APP.COMSCORE.Call()}},CBC.APP.ANA.VALIDATORS.Chartbeat={trackPageLoad:function(){window._sf_async_config.cbc&&"gamp"!==CBC.APP.SC.DTM.formatted.adobe.syndicate&&window._sf_async_config.cbc.pageChange()}},CBC.APP.ANA.VALIDATORS.Cxense={trackPageLoad:function(){CBC.APP.CXENSE&&CBC.APP.CXENSE.pageView()}},CBC.APP.ANA.VALIDATORS.HarmonizedAdobe=function(){var o=JSON.parse('{\n    "app": {\n        "name": {\n            "mediaSessionStarted": {\n                "mandatory": true,\n                "streamTypes": ["ALL_STREAM_TYPES"]\n            }\n        },\n        "version": {\n            "mediaSessionStarted": {\n                "mandatory": true,\n                "streamTypes": ["ALL_STREAM_TYPES"]\n            }\n        }\n    },\n    "cms": {\n        "content": {\n            "area": {\n                "mediaSessionStarted": {\n                    "mandatory": false,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            },\n            "cms": {\n                "mediaSessionStarted": {\n                    "mandatory": true,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            },\n            "genre": {\n                "level1": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["ALL_STREAM_TYPES"]\n                    }\n                }\n            },\n            "id": {\n                "mediaSessionStarted": {\n                    "mandatory": true,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            },\n            "keywords": {\n                "mediaSessionStarted": {\n                    "mandatory": false,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            },\n            "media": {\n                "chapter_length": {\n                    "mediaChapterStarted": {\n                        "mandatory": true,\n                        "streamTypes": ["ALL_STREAM_TYPES"]\n                    }\n                },\n                "chapter_name": {\n                    "mediaChapterStarted": {\n                        "mandatory": true,\n                        "streamTypes": ["ALL_STREAM_TYPES"]\n                    }\n                },\n                "chapter_number": {\n                    "mediaChapterStarted": {\n                        "mandatory": true,\n                        "streamTypes": ["ALL_STREAM_TYPES"]\n                    }\n                },\n                "chapter_start": {\n                    "mediaChapterStarted": {\n                        "mandatory": true,\n                        "streamTypes": ["ALL_STREAM_TYPES"]\n                    }\n                },\n                "episode": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["on-demand"]\n                    }\n                },\n                "is_full_episode": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["ALL_STREAM_TYPES"]\n                    }\n                },\n                "length": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["on-demand"]\n                    }\n                },\n                "liveondemand": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["ALL_STREAM_TYPES"]\n                    }\n                },\n                "media_title": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["ALL_STREAM_TYPES"]\n                    }\n                },\n                "region": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["ALL_STREAM_TYPES"]\n                    }\n                },\n                "season": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["on-demand"]\n                    }\n                },\n                "sport": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["ALL_STREAM_TYPES"]\n                    }\n                },\n                "stream_type": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["ALL_STREAM_TYPES"]\n                    }\n                }\n            },\n            "producer": {\n                "name": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["on-demand"]\n                    }\n                }\n            },\n            "published": {\n                "date": {\n                    "mediaSessionStarted": {\n                        "mandatory": false,\n                        "streamTypes": ["live", "on-demand"]\n                    }\n                }\n            },\n            "station_code": {\n                "mediaSessionStarted": {\n                    "mandatory": false,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            },\n            "tier": {\n                "mediaSessionStarted": {\n                    "mandatory": false,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            },\n            "title": {\n                "mediaSessionStarted": {\n                    "mandatory": false,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            },\n            "type": {\n                "mediaSessionStarted": {\n                    "mandatory": false,\n                    "streamTypes": ["ALL_STREAM_TYPES"],\n                    "allowlistLocation": "content.media.type"\n                }\n            }\n        },\n        "department": {\n            "level1": {\n                "mediaSessionStarted": {\n                    "mandatory": false,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            },\n            "level2": {\n                "mediaSessionStarted": {\n                    "mandatory": false,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            },\n            "level3": {\n                "mediaSessionStarted": {\n                    "mandatory": false,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            }\n        }\n    },\n    "feature": {\n        "instance": {\n            "mediaSessionStarted": {\n                "mandatory": false,\n                "streamTypes": ["ALL_STREAM_TYPES"]\n            }\n        },\n        "name": {\n            "mediaSessionStarted": {\n                "mandatory": false,\n                "streamTypes": ["ALL_STREAM_TYPES"]\n            }\n        },\n        "position": {\n            "mediaSessionStarted": {\n                "mandatory": false,\n                "streamTypes": ["ALL_STREAM_TYPES"]\n            }\n        },\n        "value": {\n            "mediaSessionStarted": {\n                "mandatory": false,\n                "streamTypes": ["ALL_STREAM_TYPES"]\n            }\n        }\n    },\n    "player": {\n        "mediaAdBreak": {\n            "name": {\n                "mediaAdBreakStarted": {\n                    "mandatory": true,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            },\n            "offset": {\n                "mediaAdBreakStarted": {\n                    "mandatory" : true,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            },\n            "podIndex": {\n                "mediaAdBreakStarted": {\n                    "mandatory": true,\n                    "streamTypes": ["ALL_STREAM_TYPES"]\n                }\n            }\n        },\n        "name": {\n            "mediaSessionStarted": {\n                "mandatory": false,\n                "streamTypes": ["ALL_STREAM_TYPES"]\n            }\n        },\n        "playhead": {\n            "mediaSessionStarted": {\n                "mandatory": true,\n                "streamTypes": ["ALL_STREAM_TYPES"]\n            },\n            "mediaAdBreakStarted": {\n                "mandatory": true,\n                "streamTypes": ["ALL_STREAM_TYPES"]\n            },\n            "mediaChapterStarted": {\n                "mandatory": true,\n                "streamTypes": ["ALL_STREAM_TYPES"]\n            },\n            "mediaOther": {\n                "mandatory": true,\n                "streamTypes": ["ALL_STREAM_TYPES"]\n            }\n        }\n    },\n    "sponsor": {\n        "name": {\n            "mediaSessionStarted": {\n                "mandatory": false,\n                "streamTypes": ["on-demand"]\n            }\n        }\n    }\n}\n');return{trackPageLoad:function(){CBC.APP.ANA.FORMATTERS.HarmonizedAdobe.formatPageLoad()},trackEvent:function(e,t){CBC.APP.ANA.FORMATTERS.HarmonizedAdobe.formatSignal(e,t)},trackMediaState:function(e,t){if(!t.media_object)throw{name:"MEDIAOBJ_NOT_FOUND",message:"The media_object object was not found at its expected location in the payload."};var n=Object.getOwnPropertyNames(t.media_object)[0],a=window.CBCRC.ANA.MEDIA.getActivePlayerList();if(!(n&&{}.hasOwnProperty.call(a,n)&&["mediaAdBreakCompleted","mediaAdBreakStarted","mediaBufferCompleted","mediaBufferStarted","mediaChapterStarted","mediaChapterCompleted","mediaCompleted","mediaPaused","mediaPlayStarted","mediaSeekStarted","mediaSeekCompleted","mediaSessionCompleted","mediaSessionStarted"].includes(e)))throw{name:"MEDIAOBJ_ID_INVALID",message:"The Harmonized Media Tracking ID is either missing or not properly mapped against vendor media tracking."};a=t.media_object[n],n=window.CBCRC.ANA.DATALAYER.validateMediaProperties(e,a,o,[]);if(n.returnCode)throw n;window.CBC.APP.ANA.FORMATTERS.HarmonizedAdobe.formatMediaSignal(e,t)}}}(),CBC.APP.ANA.VALIDATORS.ESS={trackEvent:function(e,t){var n=CBC.APP.ANA.FORMATTERS.ESS.generateGoogleCloudPayload(),t=JSON.parse(JSON.stringify(t));if(CBC.APP.ANA.FORMATTERS.ESS&&CBC.APP.SC.masterSwitch&&CBC.APP.SC.masterSwitch.switches&&!CBC.APP.SC.UTIL.getDoNotTrackValue())return e=e.toUpperCase(),!!["LISTENED","LOADED","READ","STREAMED","WATCHED"].includes(e)&&("LOADED"!==e||"story"==CBC.APP.SC.DTM.formatted.raw.contenttype)&&("READ"===e?!(!CBC.APP.SC.masterSwitch.switches.essv0||n&&n.content&&(!n.content.id||"comments"===n.content.type))&&void CBC.APP.ANA.FORMATTERS.ESS.formatSignal(e,n):!!CBC.APP.SC.masterSwitch.switches.essv1&&void CBC.APP.ANA.FORMATTERS.ESS.formatSignal(e,t))}},CBC.APP.ANA.DISPATCHERS.Adobe={dispatch:function(e){e.t()}},CBC.APP.ANA.DISPATCHERS.Amplitude={dispatch:function(e,t){window.amplitude.getInstance("stats").logEvent(e,t)}},CBC.APP.ANA.DISPATCHERS.FBPIXEL={pageView:function(){fbq("trackCustom","LOADED")}},CBC.APP.ANA.DISPATCHERS.MirRoar={dispatch:function(e){CBC.APP.SC.UTIL.makePOSTRequest("https://us-central1-digitalproducts-gabbo.cloudfunctions.net/web_streaming_prod",JSON.stringify(e),{success:function(e,t){},failure:function(e,t){}},{success:{uri:"https://us-central1-digitalproducts-gabbo.cloudfunctions.net/web_streaming_prod"},failure:{payload:e,uri:"https://us-central1-digitalproducts-gabbo.cloudfunctions.net/web_streaming_prod"}},null,{"Content-Type":"application/json"})}},CBC.APP.ANA.DISPATCHERS.HarmonizedAdobe={trackEvent:function(e){s_cbc_sitecatalyst&&s_cbc_sitecatalyst.tl(!0,"o",e)},trackPageLoad:function(){s_cbc_sitecatalyst&&(s_cbc_sitecatalyst.events="",s_cbc_sitecatalyst.t())},trackMediaSignal:function(e,t,n){var a=Object.getOwnPropertyNames(t.media_object)[0],o=window.CBCRC.ANA.MEDIA.getActivePlayerList();if(!{}.hasOwnProperty.call(o,a))throw{name:"MEDIA_ID_INVALID",message:"The media tracking ID supplied is either invalid or expired. Dispatch aborted."};var i=o[a],r=t.media_object[a],s=Number(r.player.playhead);switch(e){case"mediaAdBreakCompleted":CBC.APP.SC.VideoHeartbeat.adComplete(i,{id:"Not Specified"}),CBC.APP.SC.VideoHeartbeat.adBreakComplete(i,{playhead:s});break;case"mediaAdBreakStarted":var c=n[0];CBC.APP.SC.VideoHeartbeat.adBreakStart(i,c);CBC.APP.SC.VideoHeartbeat.adStart(i,{id:"Not Specified",length:1,name:"Not Specified",position:1});break;case"mediaBufferCompleted":CBC.APP.SC.VideoHeartbeat.bufferComplete(i,{playhead:s});break;case"mediaBufferStarted":CBC.APP.SC.VideoHeartbeat.bufferStart(i,{playhead:s});break;case"mediaChapterStarted":c=n[0];CBC.APP.SC.VideoHeartbeat.chapterStart(i,c);break;case"mediaChapterCompleted":CBC.APP.SC.VideoHeartbeat.chapterComplete(i,{playhead:s});break;case"mediaCompleted":CBC.APP.SC.VideoHeartbeat.videoComplete(i,{playhead:s});break;case"mediaPaused":CBC.APP.SC.VideoHeartbeat.videoPause(i,{playhead:s});break;case"mediaPlayStarted":CBC.APP.SC.VideoHeartbeat.videoPlay(i,{playhead:s});break;case"mediaSeekCompleted":CBC.APP.SC.VideoHeartbeat.seekComplete(i,{playhead:s});break;case"mediaSeekStarted":CBC.APP.SC.VideoHeartbeat.seekStart(i,{playhead:s});break;case"mediaSessionCompleted":CBC.APP.SC.VideoHeartbeat.videoUnload(i),CBCRC.ANA.MEDIA.destroy(a);break;case"mediaSessionStarted":c=n[0],c=(CBC.APP.SC.VideoHeartbeat.init(c),n[1]);CBC.APP.SC.VideoHeartbeat.videoLoad(i,c,r);break;default:throw CBC.APP.ANA.ER.report("Unknown Harmonized Signal ".concat(e),e,[CBC.APP.ANA.ER.TAG_TYPES.error.VAL,CBC.APP.ANA.ER.TAG_TYPES.tracking.MEDIA]),{name:"MEDIA_SIGNAL_UNKNOWN",message:"The media signal being dispatched is not recognized. Dispatch aborted."}}}},CBC.APP.ANA.DISPATCHERS.ESS={trackEvent:function(n,a,o){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:3,r=(new Map).set(500,!0).set(502,!0).set(503,!0).set(504,!0),e=("READ"===n?CBC.APP.SC.masterSwitch.googlecloud.essv0:CBC.APP.SC.masterSwitch.googlecloud.essv1).url;CBC.APP.SC.UTIL.makePOSTRequest(e,JSON.stringify(a),{success:function(e,t){void 0!==o&&o(JSON.parse(e.response))},failure:function(e,t){r.has(e.status)&&0<i?(--i,setTimeout(function(){CBC.APP.ANA.DISPATCHERS.ESS.trackEvent(n,a,o,i)},2e3)):r.has(e.status)&&i<=0?(console.log("ERROR: ESS Server too busy or overloaded."),console.log("    URL: "+t.failure.uri),console.log("    Payload: "+JSON.stringify(t.failure.payload))):400===e.status?(console.log("ERROR: Missing or malformed ESS Payload."),console.log("    Payload: "+JSON.stringify(t.failure.payload))):(console.log("ERROR: Unable to talk to ESS Enpoint."),console.log("    URL: "+t.failure.uri))}},{success:{uri:e},failure:{payload:a,uri:e}},null,{"Content-Type":"application/json"})}},function(){var e,t=/cbckids\.(ca|com)|cbc\.(ca|com)(:\d{4})?\/kids($|\/|cbc2|news|fantasyhockey)|subscriptions\.cbc\.ca\/widget\/KID|gem\.cbc\.ca\/category\/kids/i,n=((n=h=h||{}).BLUECONIC="blueconic",n.LOTAME="lotame",(e=e||{}).GLOBAL_DISABLE_USER_TRACKING="globalDisableUserTracking",["www.cbc.ca","gem.cbc.ca","newsinteractives.cbc.ca","cbchelp.cbc.ca","subscriptions.cbc.ca"]),o={watch:!0,live:!0,betalisten:!0,gem:!0},i={artists:!0},l=(s.prototype.getProductHostName=function(){if(null==this.productHostName){this.productHostName=this.hostname||"";var e=this.hostname.split("."),t=null,n=null,a=null;if(2<=e.length&&(t=e[e.length-1],n=e[e.length-2],3<=e.length)&&(a=e[0]),"ca"===t){e=null;if("cbc"===n)e=o;else{if("cbcmusic"!==n)return this.productHostName;e=i}this.productHostName=(e[a]?"".concat(a,"."):"").concat(n,".").concat(t)}}return this.productHostName},s.getLocationUrl=function(){return window.location.href},s),r=(Object.defineProperty(a,"spa",{get:function(){return!0===(window.CBC.APP.SC.DTM.DATA&&window.CBC.APP.SC.DTM.DATA.spa)},enumerable:!1,configurable:!0}),Object.defineProperty(a,"keywords",{get:function(){var e=window.CBC.APP.SC.DTM.formatted&&window.CBC.APP.SC.DTM.formatted.lotame&&window.CBC.APP.SC.DTM.formatted.lotame.keywords;return void 0===e?null:e},enumerable:!1,configurable:!0}),Object.defineProperty(a,"contentType",{get:function(){return window.CBC.APP.SC.DTM.DATA&&window.CBC.APP.SC.DTM.DATA.contenttype||""},enumerable:!1,configurable:!0}),Object.defineProperty(a,"url",{get:function(){return window.CBC.APP.SC.DTM.formatted&&window.CBC.APP.SC.DTM.formatted.lotame&&window.CBC.APP.SC.DTM.formatted.lotame.url||l.getLocationUrl()||""},enumerable:!1,configurable:!0}),Object.defineProperty(a,"userTier",{get:function(){return window.CBC.APP.SC.DTM.DATA&&window.CBC.APP.SC.DTM.DATA.userTier||""},enumerable:!1,configurable:!0}),Object.defineProperty(a,"sponsorName",{get:function(){return window.CBC.APP.SC.DTM&&window.CBC.APP.SC.DTM.formatted&&window.CBC.APP.SC.DTM.formatted.raw&&window.CBC.APP.SC.DTM.formatted.raw.sponsor&&window.CBC.APP.SC.DTM.formatted.raw.sponsor.name||""},enumerable:!1,configurable:!0}),Object.defineProperty(a,"grapeshotCategories",{get:function(){return window.CBC.APP.SC.DTM.DATA&&window.CBC.APP.SC.DTM.DATA.grapeshotCategories||[]},enumerable:!1,configurable:!0}),Object.defineProperty(a,"grapeshotKeywords",{get:function(){return window.CBC.APP.SC.DTM.DATA&&window.CBC.APP.SC.DTM.DATA.grapeshotKeywords||[]},enumerable:!1,configurable:!0}),a),u=function(e,r,s,c){return new(s=s||Promise)(function(n,t){function a(e){try{i(c.next(e))}catch(e){t(e)}}function o(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,o)}i((c=c.apply(e,r||[])).next())})},d=function(a,o){var i,r,s,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,r&&(s=2&t[0]?r.return:t[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;switch(r=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,r=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!((s=0<(s=c.trys).length&&s[s.length-1])||6!==t[0]&&2!==t[0])){c=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))c.label=t[1];else if(6===t[0]&&c.label<s[1])c.label=s[1],s=t;else{if(!(s&&c.label<s[2])){s[2]&&c.ops.pop(),c.trys.pop();continue}c.label=s[2],c.ops.push(t)}}t=o.call(a,c)}catch(e){t=[6,e],r=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}};function a(){}function s(e){var t=this,e=(this.hostname="",this.pathname="",this.path=[],this.query="",this.params={},this.fragment="",this.productHostName=null,e=(e=e||"").toLowerCase(),new URL(e,"https://www.cbc.ca"));e.hostname&&(this.hostname=e.hostname.replace(/^www\./,"")),e.pathname&&(this.pathname=e.pathname,this.path=e.pathname.split("/").filter(Boolean)),e.hash&&(this.fragment=e.hash.replace(/^#/,"")),e.search&&(this.query=e.search.slice(1),this.query.split("&").forEach(function(e){e=e.split("=");t.params[e[0]]=decodeURIComponent(e[1])}))}function c(e){var t=new Promise(function(e){window.vfQ=window.vfQ||[],window.vfQ.push(function(){e(null)})}),n=e.logger;function a(){return window.vf?2:window.viafoura?1:0}function o(){return t.then(function(){return 1<a()?window.vf:window.viafoura})}function i(){var e=this;return t.then(function(){return u(e,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return 1<a()?[4,o()]:[3,2];case 1:return[2,e.sent().context.get("user")];case 2:return[4,o()];case 3:return[2,e.sent().users.current()]}})})})}function r(){return u(this,void 0,void 0,function(){var t;return d(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,i()];case 1:return t=e.sent(),"guest"!==(t=t.user_privilege)&&t?[2,t]:[2,null];case 2:return e.sent(),n.debug("user has no privilege!"),[2,null];case 3:return[2]}})})}function s(){return u(this,void 0,void 0,function(){var t,n;return d(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,i()];case 1:return t=e.sent(),n=1<a()?1e3:1,[2,Math.floor(t.date_created/n)||0];case 2:return e.sent(),[2,0];case 3:return[2]}})})}function c(){return u(this,void 0,void 0,function(){var t;return d(this,function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,i()];case 1:return t=e.sent(),1===a()?[2,t.comments_made]:[4,t.data_count()];case 2:return[2,e.sent().commentsMade||0];case 3:return e.sent(),[2,0];case 4:return[2]}})})}return{viafouraLoaded:t,version:a,api:o,user:i,isLoggedIn:function(){return u(this,void 0,void 0,function(){var t;return d(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,r()];case 1:return[2,(t=e.sent())&&"guest"!==t];case 2:return e.sent(),[2,!1];case 3:return[2]}})})},userId:function(){return u(this,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,i()];case 1:return[2,e.sent().id||null];case 2:return e.sent(),[2,null];case 3:return[2]}})})},userPrivilege:r,userDateCreated:s,commentsMade:c,activityRange:function(){return u(this,void 0,void 0,function(){var a,o;return d(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Promise.all([s(),c()])];case 1:return o=e.sent(),a=o[0],o=o[1],[2,(t=a,n=o,(n/=(Math.floor(Date.now()/1e3)-t+1)/86400)<=0?"inactive":n<=1?"less than 1 comment per day":n<=5?"1-5 comments per day":n<=16?"5-16 comments per day":"more than 16 comments per day")];case 2:return e.sent(),[2,"inactive"];case 3:return[2]}var t,n})})}}}function A(e,t,n){if(n||2===arguments.length)for(var a,o=0,i=t.length;o<i;o++)!a&&o in t||((a=a||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))}function C(e,r,s,c){return new(s=s||Promise)(function(n,t){function a(e){try{i(c.next(e))}catch(e){t(e)}}function o(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(a,o)}i((c=c.apply(e,r||[])).next())})}function P(a,o){var i,r,s,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(n){return function(e){var t=[n,e];if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,r&&(s=2&t[0]?r.return:t[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;switch(r=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,r=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!((s=0<(s=c.trys).length&&s[s.length-1])||6!==t[0]&&2!==t[0])){c=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))c.label=t[1];else if(6===t[0]&&c.label<s[1])c.label=s[1],s=t;else{if(!(s&&c.label<s[2])){s[2]&&c.ops.pop(),c.trys.pop();continue}c.label=s[2],c.ops.push(t)}}t=o.call(a,c)}catch(e){t=[6,e],r=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}}_.prototype.init=function(){this._pageChangeSub=this.update.bind(this),this.pubSub.subscribe("pageChange",this._pageChangeSub)},_.prototype.update=function(){900<=this.getSecondsDiff()?(this.pubSub.publish("startGeoipSession"),this.updateSessionTime()):this.logger.debug("Skipping Geoip update")},Object.defineProperty(_.prototype,"city",{get:function(){return"function"==typeof window.geoip_city?window.geoip_city():""},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"region",{get:function(){return"function"==typeof window.geoip_region?window.geoip_region():""},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"countryCode",{get:function(){return"function"==typeof window.geoip_country_code?window.geoip_country_code():""},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"fsa",{get:function(){return"function"==typeof window.geoip_postal_code?window.geoip_postal_code():""},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"geoipData",{get:function(){var e=[];return this.city&&e.push("city : "+this.city),this.region&&e.push("region code : "+this.region),this.countryCode&&e.push("country code : "+this.countryCode),this.fsa&&e.push("fsa : "+this.fsa),e},enumerable:!1,configurable:!0}),_.prototype.loadGeoipScript=function(){var t=this;return new Promise(function(e){window.CBC.APP.SC.UTIL.loadScript("//geoip.radio-canada.ca/geoip.js",function(){e(t.geoipData)},!0,!0)})},_.prototype.updateSessionTime=function(){var e={value:!0,timestamp:(new Date).getTime()};try{window.sessionStorage.setItem("geoip",JSON.stringify(e))}catch(e){void 0===window.sessionStorage?this.logger.debug("This browser doesn't support sessionStorage. The error message is {0}",e):this.logger.debug("Unable to store geoip in sessionStorage: {0}",e)}},_.prototype.getSessionTime=function(){try{return JSON.parse(window.sessionStorage.getItem("geoip")).timestamp}catch(e){return void 0===window.sessionStorage?this.logger.debug("This browser doesn't support sessionStorage. The error message is {0}",e):this.logger.debug("No value for key 'geoip' in sessionStorage or 'timestamp' in geoip."),0}},_.prototype.getSecondsDiff=function(){var e=(new Date).getTime(),e=Math.floor((e-this.getSessionTime())/1e3);return this.logger.trace("Time difference: {0}",e),e};var p,S,h,b,m,f,M=_,g=(k.TYPES={INTEREST:"int",GENERIC_PROPERTY:"genp",CUSTOM_SEGMENT:"seg",ACTION:"act",MEDIA:"med",GENERIC_GEO:"geo",GENERIC_DEMO:"dem",SITEMAPS:"sm",ADVERTISER:"adv"},k),V=(I.prototype.listSubPaths=function(e,t){void 0===t&&(t=" : ");var n=[],a=e.path.slice(0),o=(-1!==e.fragment.indexOf("/")&&0<(e=e.fragment.split("/").filter(Boolean)).length&&(a=A(A(A([],a,!0),["#"],!1),e,!0)),[]);return a.forEach(function(e){o.push(e),"#"!==e&&n.push(o.join(t))}),n},I.prototype.buildLoadedBehaviours=function(e){var t=e.url,n=e.contentType,a=e.keywords,o=e.gsCategories,i=e.gsKeywords,r=e.userTier,s=e.sponsorName,e=e.eventData,c=this.buildSiteTrafficBehaviours(t),u=this.buildSiteSectionBehaviours(t,n),d=[],A=[],a=("story"===n&&(d=this.buildKeywordBehaviours(a),A=this.buildGrapeshotBehaviours(o,i)),this.buildTimestampBehaviours("Page View")),o=new l(l.getLocationUrl()),i=this.buildCampaignReferralBehaviours(o),o=[],n=(n&&"index"===n&&(o=this.buildLandingPageBehaviours(t)),this.buildUserTierBehaviours(t,r)),r=this.buildSponsorBehaviours(t,s),s=[];return e&&(s=this.buildOttVideoMetadataBehaviours(t,e)),[].concat(c,u,d,A,a,i,o,n,r,s)},I.prototype.buildUserTierBehaviours=function(e,t){var n=[],e=e?e.getProductHostName():"",e="".concat(e," : loaded");return t&&n.push(new g(g.TYPES.ACTION,"".concat(e," : user tier : ").concat(t))),n},I.prototype.buildSponsorBehaviours=function(e,t){var n=[],e=e?e.getProductHostName():"",e="".concat(e," : loaded");return t&&n.push(new g(g.TYPES.INTEREST,"".concat(e," : sponsor : ").concat(t))),n},I.prototype.buildSiteTrafficBehaviours=function(e){e=e?e.getProductHostName():"";return[new g(g.TYPES.INTEREST,"".concat(e," : Total Site Traffic"))]},I.prototype.buildSiteSectionBehaviours=function(e,t){var n=[],a=e?e.getProductHostName():"",o="".concat(a," : Site Section");if(0===e.path.length)n.push(new g(g.TYPES.INTEREST,"".concat(o," : homepage")));else for(var i=this.listSubPaths(e),r=0;r<i.length;r++){var s=g.TYPES.INTEREST;r===i.length-1&&t&&"index"!==t&&(s=g.TYPES.MEDIA),n.push(new g(s,"".concat(o," : ").concat(i[r])))}return n},I.prototype.buildLandingPageBehaviours=function(e){var t=[],n=e?e.getProductHostName():"",n="".concat(n," : Landing Page");return 0<e.path.length&&(e=this.listSubPaths(e),t.push(new g(g.TYPES.MEDIA,"".concat(n," : ").concat(e[e.length-1])))),t},I.prototype.toPascalCase=function(e){return e.match(/[a-z]+/gi).map(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}).join(" ")},I.prototype.buildSubjectKeywordBehaviours=function(e){var i=["Demographic Group","Demographic groups","Child and teen health","Sexual and reproductive health","Death and dying","Diagnosis and treatment","Diseases and conditions","Eye health","Heart health","Men's health","Women's health","Mental health","Oral health","Injuries","Seniors' health"],r=["cancer"],s={"&#39;":"'","&#x27;":"'"},c=[],t=g.TYPES.INTEREST;if(!(e instanceof Array))return[];for(var u=this,n=0,a=e;n<a.length;n++){var o=function(e){var t="Keyword : "+u.toPascalCase(e.type);if(!(e=e.path))return{value:[]};if(e=e.replace(new RegExp(Object.keys(s).join("|"),"g"),function(e){return s[e]})){var n=e.split("/").filter(Boolean);if(i.some(function(e){return n.includes(e)})||r.some(function(t){return n.some(function(e){return e.includes(t)})}))return"continue";for(var a=0,o=n;a<o.length;a++)t+=" : "+o[a],-1===c.indexOf(t)&&c.push(t)}}(a[n]);if("object"==_typeof(o))return o.value}return c.map(function(e){return new g(t,e)})},I.prototype.buildKeywordBehaviours=function(e){var t,n=[],a=g.TYPES.INTEREST;if(e&&(e.concepts instanceof Array&&(t=this.buildSubjectKeywordBehaviours(e.concepts),n=n.concat(t)),e.tags instanceof Array)){for(var o=[],i=0,r=e.tags;i<r.length;i++){var s=r[i],s="Keyword : "+this.toPascalCase(s.type)+" : "+s.name;o.push(new g(a,s))}n=n.concat(o)}return n},I.prototype.buildGrapeshotBehaviours=function(e,t){function n(t){return function(e){e&&a.push(new g(g.TYPES.ADVERTISER,"grapeshot : ".concat(t," : ").concat(e.trim())))}}var a=[];return e.forEach(n("category")),t.forEach(n("keyword")),a},I.prototype.buildShareBehaviours=function(e,t){t=t||"";var n=e?e.getProductHostName():"",a=(t=t.toLowerCase().replace(/\b[a-z]/g,function(e){return e.toUpperCase()}),"".concat(n," : Share Content")),o="".concat(n," : Share Content on ").concat(t),n=this.listSubPaths(e),i=(n.push(""),[]);return n.forEach(function(e){e=e&&" : ".concat(e),i.push(new g(g.TYPES.ACTION,"".concat(a).concat(e)),new g(g.TYPES.ACTION,"".concat(o).concat(e)))}),i},I.prototype.buildSurveySubmissionBehaviours=function(n,e){var a;return e&&e instanceof Array&&!(e.length<=0)?(a=[],e.forEach(function(e){var t="Survey Data : ".concat(n," : ").concat(e.tag," : ");e.choices instanceof Array!=0&&e.choices.forEach(function(e){a.push(new g(g.TYPES.ACTION,"".concat(t).concat(e)))})}),a):(this.logger.error("Answers does not exist or empty"),[])},I.prototype.buildSurveyLoadedBehaviour=function(e){return e?[new g(g.TYPES.ACTION,"Survey Loaded : ".concat(e))]:[]},I.prototype.buildAudienceSegmentRatingBehaviours=function(e,t,n){return"number"!=typeof n?(this.logger.error("Segment rating was not provided"),[]):(n=0<n?"like":"dislike",e="Audience Segment Feedback : ".concat(e," : ").concat(n),e=[new g(g.TYPES.INTEREST,e)],t&&(t="Family Feedback : ".concat(t," : ").concat(n),e.push(new g(g.TYPES.INTEREST,t))),e)},I.prototype.buildTimestampBehaviours=function(e){var t=new Date,n="Timestamp",a={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"}[t.getDay()],t=t.getHours(),t=(t<10?"0":"").concat(t,":00");return[new g(g.TYPES.ACTION,"".concat(n," : ").concat(t," : ").concat(e)),new g(g.TYPES.ACTION,"".concat(n," : ").concat(a," : ").concat(e)),new g(g.TYPES.ACTION,"".concat(n," : ").concat(t," : ").concat(a," : ").concat(e))]},I.prototype.buildCampaignReferralBehaviours=function(e){var t,n;return e.params&&void 0!==e.params.cmp&&null!==e.params.cmp?(n=decodeURI(e.params.cmp).replace(/\s+/g," ").match(/[^_]+/g),e="Referral : Campaign : ".concat(e.params.cmp),n&&"newsletter"===n[0].trim()&&(t=n[0].trim(),n=1<n.length?n[1].trim():"",e="Referral : Campaign : ".concat(t," : ").concat(n)),[new g(g.TYPES.INTEREST,"".concat(e))]):[]},I.prototype.buildRegionChangeBehaviours=function(e){return e?[new g(g.TYPES.GENERIC_GEO,"Local Region : news : ".concat(e))]:[]},I.prototype.buildAdTargetingOptOutBehaviour=function(e){return e?[new g(g.TYPES.ACTION,"Global Ad Targeting Opt Out : ".concat(e))]:[]},I.prototype.buildStartWebSessionBehaviour=function(){return[new g(g.TYPES.ACTION,"Start Web Session")]},I.prototype.buildGeoipBehaviours=function(e){if(!e.length)return[];for(var t=[],n=0,a=e;n<a.length;n++){var o=a[n];t.push(new g(g.TYPES.GENERIC_GEO,o))}return t},I.prototype.buildReadBehaviours=function(e,t){var n=[],a=e?e.getProductHostName():"";if("comments"===t)n.push(new g(g.TYPES.ACTION,"".concat(a," : Read comment")));else for(var o="".concat(a," : Read"),i=this.listSubPaths(e),r=0;r<i.length;r++){var s=g.TYPES.INTEREST;r===i.length-1&&t&&"index"!==t&&(s=g.TYPES.MEDIA),n.push(new g(s,"".concat(o," : ").concat(i[r])))}return n},I.prototype.buildCtaClickedBehaviours=function(e,t){e=e?e.getProductHostName():"";return t?[new g(g.TYPES.ACTION,"".concat(e," : CTA clicked : ").concat(t))]:[]},I.prototype.buildOttVideoMetadataBehaviours=function(e,t){var n,a=[],e=e?e.getProductHostName():"",e="".concat(e," : loaded");return t&&(a.push(new g(g.TYPES.ACTION,e)),null!=(n=t.content))&&n.title&&(n="".concat(e," : ").concat(t.content.title),a.push(new g(g.TYPES.INTEREST,n)),n=t.content.genre?" ".concat(t.content.genre," "):" ",e="".concat(e," :").concat(n,": ").concat(t.content.title),t.content.season?(n="".concat(e," : season ").concat(t.content.season),a.push(new g(g.TYPES.MEDIA,n))):a.push(new g(g.TYPES.MEDIA,"".concat(e)))),a},I),U=(O.prototype.isValidString=function(e){return"string"==typeof e&&0<e.trim().length&&"nan"!==e.toLowerCase()&&"null"!==e.toLowerCase()&&"undefined"!==e.toLowerCase()},O.prototype.getSectionsList=function(e){return e.replace(/^http[s]?:\/\//,"").split("/").slice(1)},O.prototype.buildStreamedBehaviours=function(e,t){var n,a,o=[],e=e?e.getProductHostName():"",e="".concat(e," : streamed");return t&&(o.push(new g(g.TYPES.ACTION,e)),t.content&&t.content.media&&(t.content.media.liveondemand&&"live"===t.content.media.liveondemand||"linear"===t.content.media.liveondemand?t.content.media.streamtitle&&o.push(new g(g.TYPES.INTEREST,"".concat(e," : ").concat(t.content.media.liveondemand," : ").concat(t.content.media.streamtitle))):this.isValidString(t.content.media.show)&&(n="".concat(e," : ").concat(t.content.media.show),o.push(new g(g.TYPES.INTEREST,n)),n=this.isValidString(t.content.media.genre)?" ".concat(t.content.media.genre," "):" ",n="".concat(e," :").concat(n,": ").concat(t.content.media.show),this.isValidString(t.content.media.seasonnumber)?(a="".concat(n," : season ").concat(t.content.media.seasonnumber),this.isValidString(t.content.media.episodenumber)?a="".concat(a," : episode ").concat(t.content.media.episodenumber):this.isValidString(t.content.media.streamtitle)&&(a="".concat(a," : ").concat(t.content.media.streamtitle)),o.push(new g(g.TYPES.MEDIA,a))):this.isValidString(t.content.media.episodenumber)?o.push(new g(g.TYPES.MEDIA,"".concat(n," : episode ").concat(t.content.media.episodenumber))):this.isValidString(t.content.media.streamtitle)&&o.push(new g(g.TYPES.MEDIA,"".concat(n," : ").concat(t.content.media.streamtitle))))),t.feature)&&this.isValidString(null==(a=t.feature)?void 0:a.name)&&o.push(new g(g.TYPES.ACTION,"".concat(e," : ").concat(t.feature.name))),o},O.prototype.buildStreamedShortFormVideo=function(e){var t;return e.content&&e.content.media?(t=[e.content.media.genre,e.content.media.region,e.content.media.show,e.content.title],e.content.url&&!e.content.url.match(/\/player\/play\//)&&(e=this.getSectionsList(e.content.url))&&(t.push("embedded_in"),t=t.concat(e)),e=function(e,t){for(var n,a=0,o=t.length;a<o;a++)!n&&a in t||((n=n||Array.prototype.slice.call(t,0,a))[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}(["cbc.ca","streamed"],t.filter(function(e){return e}),!0).join(" : "),[new g(g.TYPES.MEDIA,e)]):[]},O.prototype.buildSubscribedBehaviours=function(e){var t=[],e=e?e.getProductHostName():"",e="".concat(e," : subscribed");return t.push(new g(g.TYPES.ACTION,e)),t},O.prototype.buildUnsubscribedBehaviours=function(e){var t=[],e=e?e.getProductHostName():"",e="".concat(e," : unsubscribed");return t.push(new g(g.TYPES.ACTION,e)),t},O),v={FATAL:"fatal",ERROR:"error",WARN:"warn",INFO:"info",DEBUG:"debug",TRACE:"trace"},T={OFF:"OFF",FATAL:"fatal",ERROR:"error",WARN:"warn",INFO:"info",DEBUG:"debug",TRACE:"trace",ALL:"ALL"},B=[v.FATAL,v.ERROR,v.WARN,v.INFO,v.DEBUG,v.TRACE],w={LEVEL:T,CHANNEL:v,create:function(e){var n=(e=e||T.OFF)===T.OFF?0:e===T.ALL?B.length:B.indexOf(e)+1,a={};function o(e){return e&&e.toString===Object.prototype.toString?JSON.stringify(e):Array.isArray(e)?"[".concat(e.map(o).join(","),"]"):""+e}return B.forEach(function(e,t){a[e]=t<n?function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];e=e||"",t=0<n.length?t.replace(/{(\d+)}/g,function(e,t){return t in n?o(n[parseInt(t,10)]):e}):o(t),console.log("DMP: ".concat(e.toUpperCase(),": ").concat(t))}.bind(null,e):function(){}}),a}},x=(N.prototype.loginRadiusV2=function(){var n;return C(this,void 0,void 0,function(){var t;return P(this,function(e){switch(e.label){case 0:return[4,this.viafoura.api()];case 1:return t=e.sent(),[2,(null==(n=null==(n=null==t?void 0:t.core)?void 0:n.loginRadiusSVOD)?void 0:n.LRV2)||window.LoginRadiusV2]}})})},N.prototype.init=function(){return C(this,void 0,void 0,function(){return P(this,function(e){switch(e.label){case 0:return this.pubSub.subscribe("SIGNED IN",this._onSignIn),this.pubSub.subscribe("SIGNED OUT",this._onSignOut),[4,this.viafoura.viafouraLoaded];case 1:return e.sent(),this._onViafouraAvailable(),[2]}})})},Object.defineProperty(N.prototype,"accessTokenForUser",{get:function(){return window.localStorage.getItem("LRTokenKey")?window.localStorage.getItem("LRTokenKey").replace(/"/g,""):window.localStorage.getItem("lrtoken")?window.localStorage.getItem("lrtoken").replace(/"/g,""):null},enumerable:!1,configurable:!0}),N.prototype.callLoginRadiusApi=function(e){var n=this;this.util.makeGETRequest("//api.loginradius.com/identity/v2/auth/account?apikey=3f4beddd-2061-49b0-ae80-6f1f2ed65b37",{success:function(e,t){n.logger.debug("User logged in success : {0}",e.responseText),n.sendData(JSON.parse(e.responseText))},failure:function(e,t){n.logger.error("Error : login radius api call to get user profile")}},void 0,void 0,{Authorization:"Bearer "+e},void 0)},N.prototype.getGender=function(e){if(e.Identities)for(var t=0,n=e.Identities;t<n.length;t++){var a=n[t];if(a.Gender)return a.Gender}return e.CustomFields&&e.CustomFields.GenderDescription?e.CustomFields.GenderDescription:e.Gender||""},N.prototype.getAge=function(e){if(e.Identities)for(var t=0,n=e.Identities;t<n.length;t++){var a=n[t];if(a.Age)return a.Age}return e.Age||""},N.prototype.getPostalCode=function(e){var t=e.Addresses&&e.Addresses[0]&&e.Addresses[0].PostalCode;if(e.Identities)for(var n=0,a=e.Identities;n<a.length;n++){var o=a[n];if(o.Addresses&&o.Addresses[0]&&o.Addresses[0].PostalCode)return o.Addresses[0].PostalCode.substring(0,3)}return t?e.Addresses[0].PostalCode.substring(0,3):""},N.prototype.sendData=function(e){var t,n;e&&(n=this.getGender(e),t=this.getAge(e),e=this.getPostalCode(e),n=[new g(g.TYPES.GENERIC_DEMO,"User Info : Gender : "+n),new g(g.TYPES.GENERIC_DEMO,"User Info : Age : "+t),new g(g.TYPES.GENERIC_GEO,"User Info : Postal Code : "+e)],this.lotame.sendBehaviours(n))},N.prototype._onSignIn=function(){return C(this,void 0,void 0,function(){var t;return P(this,function(e){switch(e.label){case 0:return t=this.accessTokenForUser,[4,this.loginRadiusV2()];case 1:return e.sent()&&t&&this.callLoginRadiusApi(t),[2]}})})},N.prototype._onSignOut=function(){this.lotame.sendBehaviours([new g(g.TYPES.ACTION,"User Info : Sign out")])},N.prototype._onViafouraAvailable=function(){var a=this;return Promise.all([this.viafoura.userId(),this.viafoura.userPrivilege(),this.viafoura.activityRange()]).then(function(e){var t=e[0],n=e[1],e=e[2];a._sendLotameBehaviours(t,n,e)}).catch(function(e){console.log("Error Message: ",e)})},N.prototype._sendLotameBehaviours=function(e,t,n){e=e?[new g(g.TYPES.CUSTOM_SEGMENT,"Authenticated User"),new g(g.TYPES.CUSTOM_SEGMENT,"User privilege: "+t),new g(g.TYPES.CUSTOM_SEGMENT,"User activity range: "+n)]:[new g(g.TYPES.CUSTOM_SEGMENT,"Unauthenticated User")];this.lotame.sendBehaviours(e)},N),Y=(D.prototype.init=function(){this._sendSurveyDataSub=this._onSendSurveyData.bind(this),this.pubSub.subscribe("surveySubmission",this._sendSurveyDataSub),this._sendSurveyNameSub=this._onSendSurveyName.bind(this),this.pubSub.subscribe("surveyLoad",this._sendSurveyNameSub),this._storySharedSub=this._onStoryShared.bind(this),this.pubSub.subscribe("SHARED",this._storySharedSub),this._rateSegmentSub=this._onRateSegment.bind(this),this.pubSub.subscribe("rateAudienceSegment",this._rateSegmentSub),this._regionChangeSub=this._onRegionChange.bind(this),this.pubSub.subscribe("regionChange",this._regionChangeSub),this._adTargetingOptOutSub=this._onAdTargetingOptOut.bind(this),this.pubSub.subscribe("adTargetingOptOut",this._adTargetingOptOutSub),this._startWebSessionSub=this._onStartWebSession.bind(this),this.pubSub.subscribe("START WEB SESSION",this._startWebSessionSub),this._startGeoipSessionSub=this._onStartGeoipSession.bind(this),this.pubSub.subscribe("startGeoipSession",this._startGeoipSessionSub),this._videoStreamedSub=this._onVideoStreamed.bind(this),this.pubSub.subscribe("STREAMED",this._videoStreamedSub),this._subscribedEventSub=this._onSubscribedEvent.bind(this),this.pubSub.subscribe("SUBSCRIBED",this._subscribedEventSub),this._unsubscribedEventSub=this._onUnsubscribedEvent.bind(this),this.pubSub.subscribe("UNSUBSCRIBED",this._unsubscribedEventSub),this._loadedEventSub=this._onLoadedEvent.bind(this),this.pubSub.subscribe("LOADED",this._loadedEventSub),this._readEventSub=this._onReadEvent.bind(this),this.pubSub.subscribe("READ",this._readEventSub),this._ctaClickedEventSub=this._onCtaClicked.bind(this),this.pubSub.subscribe("ctaClicked",this._ctaClickedEventSub)},D.prototype._onLoadedEvent=function(e,t){this.logger.debug("LOADED subscriber");var n,a,o=r.url;o&&(a="ott-web-app"===(null==(a=null==(a=null==(a=null==(a=null==(a=window.CBC)?void 0:a.APP)?void 0:a.SC)?void 0:a.DTM)?void 0:a.DATA)?void 0:a.appname),n="shows"===(null==(n=null==(n=null==(n=null==(n=null==(n=window.CBC)?void 0:n.APP)?void 0:n.SC)?void 0:n.DTM)?void 0:n.DATA)?void 0:n.subsection1),o={url:new l(o),contentType:r.contentType,keywords:r.keywords,gsCategories:r.grapeshotCategories,gsKeywords:r.grapeshotKeywords,userTier:r.userTier,sponsorName:r.sponsorName,eventData:a&&n?t:void 0},a=this.behaviourBuilder.buildLoadedBehaviours(o),this.lotame.sendBehaviours(a,r.spa))},D.prototype._onStoryShared=function(e,t){this.logger.debug("Story shared - {0}",t);var n=new l(r.url),n=this.behaviourBuilder.buildShareBehaviours(n,t.network);this.lotame.sendBehaviours(n)},D.prototype._onSendSurveyData=function(e,t){this.logger.debug("Send survey data sub - {0}",t);t=this.behaviourBuilder.buildSurveySubmissionBehaviours(t.name,t.answers);this.lotame.sendBehaviours(t)},D.prototype._onSendSurveyName=function(e,t){this.logger.debug("Send survey name sub - {0}",t);t=this.behaviourBuilder.buildSurveyLoadedBehaviour(t);this.lotame.sendBehaviours(t)},D.prototype._onRateSegment=function(e,t){var n=t.segmentId,a=t.family,t=t.rating,n=this.behaviourBuilder.buildAudienceSegmentRatingBehaviours(n,a,t);this.lotame.sendBehaviours(n)},D.prototype._onRegionChange=function(e,t){t=this.behaviourBuilder.buildRegionChangeBehaviours(t.title);this.lotame.sendBehaviours(t)},D.prototype._onAdTargetingOptOut=function(e,t){t=this.behaviourBuilder.buildAdTargetingOptOutBehaviour(t);this.lotame.sendBehaviours(t)},D.prototype._onStartWebSession=function(e,t){var n=this.behaviourBuilder.buildStartWebSessionBehaviour();this.lotame.sendBehaviours(n)},D.prototype._onStartGeoipSession=function(e,t){var n=this;this.geoip.loadGeoipScript().then(function(e){e=n.behaviourBuilder.buildGeoipBehaviours(e);n.lotame.sendBehaviours(e)}).catch(function(){n.logger.error("Error: The script //geoip.radio-canada.ca/geoip.js failed to load")})},D.prototype._onReadEvent=function(e,t){var n=(null==(n=null==(n=null==(n=null==(n=null==(n=null==(n=null==(n=window.CBC)?void 0:n.APP)?void 0:n.SC)?void 0:n.DTM)?void 0:n.formatted)?void 0:n.googlecloud)?void 0:n.content)?void 0:n.type)||r.contentType,a=new l(r.url),a=this.behaviourBuilder.buildReadBehaviours(a,n);this.lotame.sendBehaviours(a)},D.prototype._onVideoStreamed=function(e,t){var n=new l(r.url),a=n.hostname,n=this.behaviourBuilderOtt.buildStreamedBehaviours(n,t);"gem.cbc.ca"==a||/watch.(\S)*cbc.ca/.test(a)||(n=n.concat(this.behaviourBuilderOtt.buildStreamedShortFormVideo(t))),this.lotame.sendBehaviours(n)},D.prototype._onSubscribedEvent=function(e,t){var n=new l(r.url),n=this.behaviourBuilderOtt.buildSubscribedBehaviours(n);this.lotame.sendBehaviours(n)},D.prototype._onUnsubscribedEvent=function(e,t){var n=new l(r.url),n=this.behaviourBuilderOtt.buildUnsubscribedBehaviours(n);this.lotame.sendBehaviours(n)},D.prototype._onCtaClicked=function(e,t){this.logger.debug("Send App CTA click sub - {0}",t);var n=new l(r.url),n=this.behaviourBuilder.buildCtaClickedBehaviours(n,t);this.lotame.sendBehaviours(n)},D),y="vfidtolotame",E="//bcp.crwdcntrl.net/map/c=10743/tp=VIAF/tpid=",F=w.create(w.LEVEL.ALL),H=(L.prototype.init=function(){var e=this;this.viafoura.viafouraLoaded.then(function(){e.addVfEvents()})},L.prototype.run=function(){var t=this;return this.logger.debug("Running Viafoura/Lotame sync pixel code."),this.viafoura.isLoggedIn().then(function(e){t.carryPixelOperations(e)})},L.prototype.carryPixelOperations=function(e){return p=this.getPixel(y),e?p?this.updatePixel():this.addPixel():p?this.deletePixel():void 0},L.prototype.addVfEvents=function(){return e=this,s=function(){var t,n,a,o,i,r,s,c,e,u=this;return a=this,o=function(e){switch(e.label){case 0:return this.logger.debug("Add Viafoura events"),[4,this.viafoura.viafouraLoaded];case 1:e.sent(),t=this.viafoura.version();try{1<t?this.viafoura.api().then(function(e){e.$subscribe("login","success-syncpixel",function(){u.run()})}):this.viafoura.api().then(function(e){e.subscribe("onLoginSuccess",function(){u.run()})})}catch(e){n=1<this.viafoura.version()?"Login.Success":"onLoginSuccess",this.logger.error("Can't subscribe to ".concat(n," event."))}try{1<t?this.viafoura.api().then(function(e){e.$subscribe("logout","success-syncpixel",function(){u.run()})}):this.viafoura.api().then(function(e){e.subscribe("onLogoutSuccess",function(){u.run()})})}catch(e){n=1<this.viafoura.version()?"Logout.Success":"onLogoutSuccess",this.logger.error("Can't subscribe to ".concat(n," event."))}return[2]}},c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:d(0),throw:d(1),return:d(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function d(n){return function(e){var t=[n,e];if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,r&&(s=2&t[0]?r.return:t[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,t[1])).done)return s;switch(r=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return c.label++,{value:t[1],done:!1};case 5:c.label++,r=t[1],t=[0];continue;case 7:t=c.ops.pop(),c.trys.pop();continue;default:if(!((s=0<(s=c.trys).length&&s[s.length-1])||6!==t[0]&&2!==t[0])){c=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))c.label=t[1];else if(6===t[0]&&c.label<s[1])c.label=s[1],s=t;else{if(!(s&&c.label<s[2])){s[2]&&c.ops.pop(),c.trys.pop();continue}c.label=s[2],c.ops.push(t)}}t=o.call(a,c)}catch(e){t=[6,e],r=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},new(r=(r=void 0,Promise))(function(n,t){function a(e){try{i(s.next(e))}catch(e){t(e)}}function o(e){try{i(s.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}i((s=s.apply(e,[])).next())});var e,r,s},L.prototype.getPixel=function(e){return document.getElementById(e)},L.prototype.addPixel=function(){var t=this;return this.logger.debug("Add Viafoura/Lotame sync pixel code."),this.viafoura.userId().then(function(e){e&&t._addPixelToDocument(e)})},L.prototype._addPixelToDocument=function(e){var t=document.createElement("img");t.setAttribute("src",E+e),t.setAttribute("id",y),document.body.appendChild(t)},L.prototype.updatePixel=function(){var t=this;return this.logger.debug("Update Viafoura/Lotame sync pixel code."),this.viafoura.userId().then(function(e){e&&t.getPixel(y).setAttribute("src",E+e)})},L.prototype.deletePixel=function(){this.logger.debug("Delete Viafoura/Lotame sync pixel code."),this.getPixel(y).remove()},L),v=(R.prototype.init=function(){/cbckids\.(ca|com)|cbc\.(ca|com)(:\d{4})?\/kids($|\/|cbc2|news|fantasyhockey)|subscriptions\.cbc\.ca\/widget\/KID/i.test(r.url)||window.CBC.APP.SC.UTIL.isIOSWebviewPrivate()?this.logger.debug("Not initializing DMP on CBC Kids or Kids News"):this._modules.forEach(function(e){return e.init()})},R);function R(e){this.pubSub=e.pubSub,this.util=e.util,this.logger=e.logger,this.lotame=e.lotame,this.behaviourBuilder=new V(this),this.behaviourBuilderOtt=new U(this),this.geoip=new M(this),this.subscribers=new Y(this),this.viafoura=c(this),this.syncPixel=new H(this),this.userInfo=new x(this),this._modules=[this.subscribers,this.syncPixel,this.geoip,this.userInfo]}function L(e){var t=e.viafoura,t=void 0===t?c({logger:F}):t,n=e.pubSub,e=e.logger,e=void 0===e?w:e;this.viafoura=t,this.pubSub=n,this.logger=e}function D(e){this.dmp=e,this.logger=e.logger,this.pubSub=e.pubSub,this.lotame=e.lotame,this.geoip=e.geoip,this.behaviourBuilder=e.behaviourBuilder,this.behaviourBuilderOtt=e.behaviourBuilderOtt}function N(e){var t=e.logger,n=void 0===t?w.create(null!=(n=null==(n=null==(n=window.CBC)?void 0:n.APP)?void 0:n.SC)&&n.DEBUG?w.LEVEL.DEBUG:w.LEVEL.ERROR):t,t=e.viafoura,t=void 0===t?c({logger:n}):t,a=e.lotame,o=e.pubSub,e=e.util;this.logger=n,this.viafoura=t,this.lotame=a,this.pubSub=o,this.util=e}function O(e){e=e.logger;this.logger=e}function I(e){e=e.logger;this.logger=e}function k(e,t){this.type=e,this.value=t}function _(e){var t=e.pubSub,n=e.logger,a=e.lotame,e=e.util;this.logger=n,this.lotame=a,this.pubSub=t,this.util=e}[window.Element.prototype,window.CharacterData.prototype,window.DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}),window.CBC=window.CBC||{},(m=window.CBC).APP=m.APP||{},m.APP.DMP=m.APP.DMP||{},m.APP.SC=m.APP.SC||{},m.APP.SC.UTIL=m.APP.SC.UTIL||{},(f=new v({logger:m.APP.DMP.LOGGER,lotame:m.APP.DMP.LOTAME,pubSub:m.APP.PubSub,util:m.APP.SC.UTIL})).logger.debug("DMP initialize starting"),f.init(),m.APP.DMP.pageChange=function(){f.logger.debug("Forced DMP pageChange"),r.spa&&m.APP.PubSub.publish("pageChange")},v=window.location.hostname,/^.+\.cbc\.ca$/.test(v)||window.CBC.APP.SC.UTIL.console("The top level domain should be cbc.ca or gem.cbc.ca"),b=new URLSearchParams(window.location.search),t.test(window.location.href)||b.get("ios_a_p")||1<(b="; ".concat(window.document.cookie).split("; ".concat("ios_a_p","="))).length&&b.pop().split(";").shift()?(console.debug("Not initializing BlueConic and Lotame on CBC Kids, GEM Kids or Kids News"),Promise.resolve()):(b=h.BLUECONIC,t=e.GLOBAL_DISABLE_USER_TRACKING,((h=null==(h=null==(h=null==(h=null==(h=null==(h=window.CBC)?void 0:h.APP)?void 0:h.SC)?void 0:h.dmpAudienceslist)?void 0:h.featureToggle)?void 0:h[b])?void 0===(h=h[t])?(console.error("Property ".concat(t," is not defined for ").concat(b," feature toggle.")),0):h:(console.error("".concat(b," feature toggle is not defined.")),0))?(console.debug("Blueconic initialization is disabled by the feature toggle."),Promise.resolve()):(void 0===(t=v)&&(t=window.location.hostname),S="https://cbcrc.sb.blueconic.net/script.js",n.includes(t)&&(S="https://cdp.cbc.ca/script.js"),new Promise(function(e,t){window.CBC.APP.SC.UTIL.loadScript(S,function(){e(!0)},!0)}).then(function(){window.CBC.APP.SC.UTIL.console("loadBlueConicTag: Success!")}).catch(function(e){window.CBC.APP.SC.UTIL.console(e)})))}(),CBC.APP.SC.Subscribers.pageview=CBC.APP.SC.Subscribers.pageview||[],CBC.APP.SC.PageTracker=function(){var r={},c={},u=window.CBC.APP.SC.UTIL,s=!1,d=!1;return{init:function(){try{CBC.APP.PubSub.turnOn()}catch(e){console.log("There has been an error: "+e)}var e=document.location.href;if(-1<e.indexOf("polopoly")||-1<e.indexOf("/meta/preview")||-1<e.indexOf("/preview/www")||-1<e.indexOf("/preview/web"))return u.console("Preview page. Page Tracking Disabled."),!1;if(-1!==window.Detectizr.ua.indexOf("googlebot"))return!1;u.inDebugMode(),d?(CBC.APP.ANA.FORMATTERS.Adobe.clearVariables(),window.CBC.APP.SC.Subscribers.pageview.push({cb:function(){window.dispatchEvent(new window.CustomEvent("ConductricsStateChange",{detail:window.s_cbc_sitecatalyst.pageName}))}})):document.addEventListener("click",CBC.APP.ANA.LinkTracker.checkClickEvent);var e=CBC.APP.versions["cbc-stats-top"],t=CBC.APP.versions["cbc-stats-bottom"],e=(void 0!==e&&void 0!==t&&this.checkStatsVersions(e,t),void 0===CBC.APP.SC.DTM&&(CBC.APP.SC.DTM={}),void 0===CBC.APP.SC.DTM.DATA&&(CBC.APP.SC.DTM.DATA={}),0<Object.keys(CBC.APP.SC.DTM.DATA).length?r.prop75="new":(u.console("Data Layer - Data layer not found. Defaulting to URL."),CBC.APP.SC.DTM.DATA=this.urlToObj(document.location.hostname,document.location.pathname),r.prop75="dne"),CBC.APP.SC.DTM.DATA.authenticated=this.isLoggedIn(),u.initReferringDepartmentStatus(),u.setFormattedLayer(),CBC.APP.readJS.checkLoad(),!s&&window.vf&&window.vf.$once&&(window.vf.$once("comments","read",function(e){window.vf.context.get("page").then(function(e){e.num_replies&&CBC.APP.SC.EventTracker.trackEvent("READ",{content:{type:"comments"}})}),s=!1}),s=!0),{}),t="LOADED",n=this.readLinkTrackerCookie(),a={},a=((n.prop22||n.prop23||n.prop24||n.dataFeatureValue)&&(e.feature={},a.feature={},n.prop22&&(e.feature.name=n.prop22,a.feature.name=n.prop22),n.prop23&&(e.feature.instance=n.prop23,a.feature.instance=n.prop23),n.prop24&&(e.feature.position=n.prop24,a.feature.position=n.prop24),n.dataFeatureValue)&&(e.feature.value=n.dataFeatureValue,a.feature.value=n.dataFeatureValue),Object.assign(n,r),e.linkTrackObj=JSON.parse(JSON.stringify(n)),window.conductricsDataLayer=window.conductricsDataLayer||[],CBC.APP.SC.DTM&&(a.feature?(n=Object.assign({},CBC.APP.SC.DTM,a),window.conductricsDataLayer.push(n)):window.conductricsDataLayer.push(CBC.APP.SC.DTM)),CBC.APP.SC.DTM.formatted.raw),o=("LOADED"===(t=a.referrer&&a.referrer.url===a.url?"LOADED MORE":t)&&(e.custom={},e.custom.DNT=CBC.APP.SC.UTIL.getDoNotTrackValue(),e.custom.cookiesenabled=window.navigator.cookieEnabled),CBC.APP.PubSub.publish("pageChange"),CBC.APP.SC.EventTracker.trackEvent(t,e),d||(d=!0,window.viafoura&&window.viafoura.users&&window.viafoura.users.current&&window.viafoura.users.current().id?u.setCBCPlusIDPromise().catch(function(e){CBC.APP.SC.UTIL.console(e)}):u.setCBCVisitorIDPromise().catch(function(e){CBC.APP.SC.UTIL.console(e)})),0),i=window.setInterval(function(){var e=window.s_cbc_sitecatalyst;if(e.pageName&&e.events||39<o){for(var t=CBC.APP.SC.Subscribers.pageview,n=t.length,a=0,a=0;a<n;++a)"function"==typeof t[n-a-1].cb?t.pop().cb():t.pop();window.clearInterval(i)}else++o},10);return!0},urlToObj:function(e,t){var n,a=t.split("/"),o={},i=0;e.match("cbcmusic")?o.contentarea="music":o.contentarea="misc";for(var i=1,r=0;r<a.length;++r)""!==a[r]&&(n="subsection".concat(i),++i,o[n]=u.sanitize(a[r]));return o.contenttype="index",o.url="https://".concat(e).concat(t),o},setInitialized:function(){d=!0},readLinkTrackerCookie:function(){var t="SC_LINKS",n="DATA_FEATURE_LINKS",e={};try{var a,o,i,r,s=u.getCookie(n);s?(a=JSON.parse(s),o=CBC.APP.SC.UTIL.getMetadataAllowlist().metadata.allowlist.feature,i={},Object.keys(o).forEach(function(e){for(var t in i[e]={},o[e])i[e][window.CBC.APP.SC.UTIL.cleanString(t)]=o[e][t]}),e.prop21=a.pageName,e.prop22=i.name[a.dataFeatureName]?a.dataFeatureName:void 0,e.prop23=i.instance[a.dataFeatureInstance]?a.dataFeatureInstance:void 0,e.prop24=new RegExp(i.position.pattern).test(a.dataFeaturePosition)?a.dataFeaturePosition:void 0,e.dataFeatureValue=i.value[a.dataFeatureValue]?a.dataFeatureValue:void 0):(s=u.getCookie(t),CBC.APP.SC.masterSwitch.switches.legacysclt&&s&&(r=JSON.parse(s),e.prop21=r.pageName,e.prop22=r.linkName,e.prop24=r.linkPosition))}catch(e){return u.setCookie(n,"",0),u.setCookie(t,"",0),{}}return u.setCookie(n,"",0),u.setCookie(t,"",0),c=JSON.parse(JSON.stringify(e)),e},getLinkTrackObj:function(){return c},isLoggedIn:function(){try{return"guest"!==window.viafoura.users.current().user_privilege}catch(e){return!1}},isCommentor:function(){try{return 0<window.viafoura.users.current().comments_made}catch(e){return!1}},checkStatsVersions:function(e,t){return r.prop70="".concat(e===t,":").concat(e,":").concat(t),e!==t&&CBC.APP.ANA.ER.report("Stats Version Mismatched: stats-top ".concat(e,", stats-bottom ").concat(t),{}),r.prop70}}}(),CBC.APP.SC.preventDefault||CBC.APP.SC.DTM.DATA.preventDefault?CBC.APP.SC.UTIL.console("Warning: Not firing page tracking on page load"):CBC.APP.SC.PageTracker.init(),function(){var e;document.getElementById("cbc-as-search-root")&&((e=document.createElement("link")).rel="stylesheet",e.id="cbc-as-search-css",e.href="/search-assets/static/css/cbc-as-search.css",document.head.appendChild(e),(e=document.createElement("script")).type="text/javascript",e.id="cbc-as-search-js",e.src="/search-assets/static/js/cbc-as-search.js",document.body.appendChild(e))}(),function(a){function e(e,t){var n=window.document.createElement("iframe");n.setAttribute("src","/g/stats/html/cmf.html?a="+e+"&m="+t+"&s=cbc&p="+encodeURIComponent(a.location.href)),n.setAttribute("id","cmf-iframe"),n.setAttribute("width","0"),n.setAttribute("height","0"),n.setAttribute("frameBorder","0"),document.body.appendChild(n)}document.getElementById("cmf-iframe")&&document.getElementById("cmf-iframe").remove();var t,n={"cbc.ca\\/xcompany\\/debriefing":"1415.11316.140589","cbc.ca\\/bellevue\\/videos\\/1994-videos":"1617.11311.146736","cbc.ca\\/kidscbc1\\/shows\\/chirp":"1213.11116.133491","cbc.ca\\/covermecanada":"1112.11416.132002","cbc.ca\\/player\\/tv\\/Halifax%20Comedy%20Festival\\/Season%2019":"1415.11453.141153","cbc.ca\\/kidscbcolympics":"1617.11116.144982","cbc.ca\\/murdochmysteries\\/onthecase":"1516.11316.142584","cbc.ca\\/murdochmysteries\\/noqs":"1213.11316.132929","cbc.ca\\/murdochmysteries\\/videos\\/making-murdoch\\/\\S+":"1314.11313.138117","cbc.ca\\/murdochmysteries\\/theinfernaldevice":"1415.11353.141147","cbc.ca\\/overtherainbow":"1213.11416.133409","cbc.ca\\/republicofdoyle\\/episodes\\/season-5\\/\\S+":"1314.11313.138147","cbc.ca\\/thebestlaidplans\\/videos\\/the-petes-laid-plans\\/\\S+":"1314.11313.138145","cbc.ca\\/22minutes\\/videos\\/22-minutes-update\\/\\S+":"1516.11353.142570","cbc.ca\\/thislife\\/videos\\/exclusives\\/\\S+":"1516.11313.142585","cbc.ca\\/workinmoms\\/videos\\/season-1\\/\\S+":"1617.11353.145375","cbc.ca\\/xcompany\\/videos\\/x-company-animated\\/\\S+":"1516.11313.142581","cbc.ca\\/shootthemessenger\\/murderboard":"1516.11315.142932","cbc.ca\\/arcticair\\/videos\\/man-of-the-north":"1112.11316.131909","cbc.ca\\/michael\\/videos\\/lost-therapy-tapes":"1112.11316.131239","cbc.ca\\/michael\\/videos\\/after-the-beep":"1112.11316.131239","comedycoup.cbc.ca\\/cc\\/canada-2014":"1415.11316.139499","cbc.ca\\/mrd\\/videos\\/xavier-gazette":"1112.11316.131856","cbc.ca\\/insecurity":"1011.11316.128616"};Object.keys(n).some(function(e){return!!new RegExp(e).test(a.location.href)&&(t=n[e],!0)})?e(t,a.document.title):a.CBC.APP.SC.DTM.DATA&&a.CBC.APP.SC.DTM.DATA.cmfAppId&&e(a.CBC.APP.SC.DTM.DATA.cmfAppId,a.CBC.APP.SC.DTM.DATA.title)}(window._window||window);